<template name="games">
  <div class="games">
    {{#if team }}{{#with team }}
      <header>
        <a href="/leagues" class="back btn"><span class="arrow"></span>Leagues</a>
        <h1>Season Games</h1>
        {{> logged_in_user }}
      </header>
      
      <article>
        {{#if next_game}}
          {{> next_game }}
          {{> upcoming_games }}
        {{else}}
          <p>No games yet!</p>
          <p>Click <a class="create_game">here</a> to create one</p>
        {{/if}}
      </article>
      
    {{/with}}{{/if}}
  </div>
</template>

<template name="next_game">
  <div class="next_game">
    <aside class="next">Next Game</aside>
      {{{ render_large_logo }}}
    <p>{{ name }}</p>
<!--     <p class="preposition">&#9733;&nbsp;&nbsp;AT&nbsp;&nbsp;&#9733;</p> -->
    {{#with next_game }}
      <h2 class="game_title">{{ location }}Game 3</h2>
      <p class="game_date"><strong>This {{ day }}</strong>&nbsp;&nbsp;{{ time }}&nbsp;&nbsp;{{ formatted_date }}</p>
      <ul class="game_players">
        {{#each player_availabilities}}
          {{> player_availability }}
        {{/each}}
      </ul>
      <a class="edit icon16 inset">Edit this game</a>
    {{/with}}
  </div>
</template>

<template name="upcoming_games">
  <div class="upcoming_games">
    <a class="view_more"><small>Rest of your games &darr;</small></a>
    <div class="season">
      <h2>Your Season</h2>
      {{#if editing}}
        <a class="done inset btn icon16 checkmark">Done Editing</a>
      {{else}}
        <a class="edit inset btn icon16">Edit games</a>
      {{/if}}
      <ul class="games">
        {{#each upcoming_games }}
          {{> game }}
        {{/each}}
        <a class="create_game btn default">Add games</a>
      </ul>
    </div>
  </div>
</template>

<template name="game">
  <li>
    <div class="date">
      {{formatted_date}}
      {{#if editing}}
        <a class="change_date">Change Date</a>
      {{/if}}
    </div>
    <div class="meta">
      {{#if editing}}
        <form name="game">
          <label for="location">Location</label>
          <input name="location" value="{{attributes.location}}" placeholder="Where is the game?"/>
          
          <label>Time</label>
          {{#with possible_hours}}{{> select }}{{/with}}
          {{#with possible_minutes}}{{> select }}{{/with}}
        </form>
      {{else}}
        <h3>
          {{#if attributes.location}}
            {{attributes.location}}
          {{else}}
            <em>Unknown location</em>
          {{/if}}
        </h3>
        {{time}}
        <!-- Fixme, make me work when the player count is low -->
        <p class="yellow_flag">{{player_count}}</p>
        <a>Game Roster &raquo;</a>
        <ul class="game_players">
          {{#each player_availabilities}}
            {{> player_availability }}
          {{/each}}
        </ul>
      {{/if}}
    </div>
    <div class="confirmation">
      <form class="state_question">
        <input type="radio" name="state" value="play">
        <label for="state" class="play">Play</label>
        <br>
        <input type="radio" name="state" value="bench">
        <label for="state" class="bench">Bench</label>
        <br>
        <em class="state">You're unconfirmed</em>
      </form>
      <div class="state_playing">
        <figure></figure>
        <br>
        <a class="inset">Get on the bench &raquo;</a>
      </div>
      <div class="state_benched">
        <figure>Benched</figure>
        <br>
        <a class="inset">Play this game &raquo;</a>
      </div>
    </div>
  </li>
</template>

<template name="player_availability">
  <li class="player {{ availability_class }}">
    {{#with player}}
      <div class="image">
        <span class="icon16 checkmark"></span>
        <span class="icon16 close"></span>
        <span class="icon16 player"></span>
        <img src="{{ facebook_profile_url }}"/>
      </div>
      <span class="name">{{attributes.name}}</span>
    {{/with}}
  </li>
</template>

